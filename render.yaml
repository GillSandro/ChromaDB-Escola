services:
  - type: web
    name: chromadb-escola
    env: docker
    plan: free
    dockerfilePath: ./Dockerfile
    envVars:
      - key: ALLOW_RESET
        value: "true"

      - key: CHROMA_SERVER_HTTP_PORT
        value: "8000"

      - key: CHROMA_SERVER_CORS_ALLOW_ORIGINS
        value: "*"

      - key: CHROMA_API_IMPL
        value: "chromadb.api.fastapi.FastAPI"
        
    # Configurações de backup no GitHub
    secretFiles:
      - name: .chroma-backup.env
        mountPath: /etc/secrets
    
    # Disco persistente para dados do Chroma
    disk:
      name: chroma-data
      mountPath: /data
      sizeGB: 1
    
    # Health check para evitar hibernação
    healthCheckPath: /api/v1/heartbeat
    autoDeploy: true        

